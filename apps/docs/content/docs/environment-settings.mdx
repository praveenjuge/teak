---
title: Environment Settings
description: Environment variables configuration for Teak
icon: Settings
---

## Quick Setup

Configure 4 environment files and sync Better Auth secrets into the Convex dashboard.

### Backend (`backend/.env.local`)

```bash
# Required
CONVEX_DEPLOYMENT=dev:name-123
CONVEX_URL=https://name-123.convex.cloud
NEXT_PUBLIC_CONVEX_SITE_URL=https://name-123.convex.site
SITE_URL=http://localhost:3000

# Optional Features
OPENAI_API_KEY=sk_...                       # AI processing
POLAR_ACCESS_TOKEN=token                    # Billing
POLAR_SERVER=sandbox                        # sandbox|production
ADMIN_USERIDS=id1,id2                       # Admin access
CLOUDFLARE_BROWSER_RENDERING_ACCOUNT_ID=id  # Screenshots
CLOUDFLARE_BROWSER_RENDERING_API_TOKEN=token
```

> Better Auth expects the same values inside Convex. Run `npx convex env set BETTER_AUTH_SECRET <secret>`, `npx convex env set SITE_URL http://localhost:3000`, and `npx convex env set CONVEX_SITE_URL https://name-123.convex.site` so cloud functions match your local `.env`.

### Web (`apps/web/.env.local`)

```bash
NEXT_PUBLIC_CONVEX_URL=https://deployment.convex.cloud
CONVEX_DEPLOYMENT=dev:name-123
NEXT_PUBLIC_CONVEX_SITE_URL=https://deployment.convex.site
SITE_URL=http://localhost:3000
```

### Mobile (`apps/mobile/.env.local`)

```bash
EXPO_PUBLIC_CONVEX_URL=https://deployment.convex.cloud
EXPO_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_...
EXPO_PUBLIC_CLERK_FRONTEND_API_URL=https://domain.clerk.accounts.dev
```

### Extension (`apps/extension/.env.local`)

```bash
VITE_PUBLIC_CONVEX_URL=https://deployment.convex.cloud
VITE_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_...
VITE_PUBLIC_CLERK_SYNC_HOST=http://localhost:3000
```

> Mobile and extension builds still lean on Clerk until their Better Auth clients land, so keep those publishable keys configured.

## Getting Values

### Convex

1. Run `bun run predev` â†’ creates deployment.
2. Backend CLI uses `dev:name-123` (from `.env.local`).
3. Frontend clients hit `https://name-123.convex.cloud`.
4. Site URL for Better Auth: `https://name-123.convex.site`.

### Better Auth (web + backend)

1. Development base URL: `http://localhost:3000`; production: your public domain.
2. Generate a secret once: `npx convex env set BETTER_AUTH_SECRET $(openssl rand -base64 32)`.
3. Mirror the base URL in both `SITE_URL` (Next.js + Convex) and `CONVEX_SITE_URL` (Convex site endpoint).
4. Re-run `npx convex env set` whenever the public domain changes.

### Clerk (mobile + extension)

1. Create/keep a Clerk app at [clerk.com](https://clerk.com).
2. Publishable key: `pk_test_...` (or `pk_live_...` in production).
3. Secret key only needed if the native clients invoke Clerk admin APIs.
4. These keys stay until the non-web clients migrate to Better Auth.

## Environment Types

| Environment | Convex Deployment     | Better Auth Site URL      | Clerk Keys (mobile/extension) |
| ----------- | --------------------- | ------------------------- | ----------------------------- |
| Development | `dev:name-123`        | `http://localhost:3000`   | `pk_test_...` / `sk_test_...` |
| Production  | Production deployment | `https://your-domain.com` | `pk_live_...` / `sk_live_...` |

## Feature Flags

| Feature         | Required Env Var                 | What it Enables                      |
| --------------- | -------------------------------- | ------------------------------------ |
| AI Processing   | `OPENAI_API_KEY`                 | Auto-tags, summaries, categorization |
| Screenshots     | `CLOUDFLARE_BROWSER_RENDERING_*` | Link preview thumbnails              |
| Billing         | `POLAR_ACCESS_TOKEN`             | Subscription management              |
| Admin Dashboard | `ADMIN_USERIDS`                  | Pipeline insights, monitoring        |

## Testing

```bash
# Playwright seeds this Better Auth account before running specs
E2E_CLERK_USER_EMAIL=test@example.com
E2E_CLERK_USER_PASSWORD=password123
```
