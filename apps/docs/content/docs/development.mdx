---
title: Development Guide
description: Development setup and workflow guide for Teak
---

## Prerequisites

- **Bun 1.0+** - Modern JavaScript runtime
- **Node.js 18+** - For package compatibility
- **Git** - Version control

## Quick Start

```bash
git clone https://github.com/praveenjuge/teak.git
cd teak
bun install
bun run predev
```

This will:

1. Install dependencies across all workspace packages
2. Initialize Convex development environment
3. Open the Convex dashboard for configuration

## Project Structure

```
teak/
├── apps/
│   ├── web/              # Next.js 16.0.1 frontend app
│   │   ├── app/          # App Router pages and layouts
│   │   │   ├── (auth)/   # Authentication routes
│   │   │   ├── (feedback)/ # Feedback integration
│   │   │   ├── admin/    # Admin dashboard
│   │   │   └── subscription/ # Billing pages
│   │   ├── components/   # React components
│   │   ├── tests/        # Playwright e2e tests
│   │   └── playwright.config.ts # E2E test config
│   ├── mobile/           # Expo React Native mobile app
│   │   ├── app/          # React Native screens
│   │   │   ├── (auth)/   # Mobile auth flows
│   │   │   ├── (feedback)/ # Mobile feedback
│   │   │   └── (tabs)/   # Main navigation tabs
│   │   └── lib/feedbackBridge.ts # Feedback system bridge
│   ├── extension/        # Chrome browser extension (Wxt)
│   │   ├── entrypoints/  # Extension entry points
│   │   ├── hooks/        # Custom React hooks
│   │   └── types/        # TypeScript definitions
│   └── docs/             # Documentation site (Fumadocs)
├── backend/
│   ├── convex/           # Convex functions and database
│   │   ├── tasks/        # Background task processors
│   │   │   ├── ai/       # AI processing tasks
│   │   │   └── cards/    # Card-specific tasks
│   │   ├── workflows/    # Workflow orchestration
│   │   │   └── steps/    # Individual workflow steps
│   │   ├── http.ts       # HTTP route handlers
│   │   ├── migrations.ts # Database migrations
│   │   └── admin.ts      # Admin functions
│   ├── shared/           # Shared utilities, constants, types
│   └── index.ts          # Re-export surface for clients
└── package.json          # Root workspace configuration
```

### Core Stack

- **Backend**: Convex (real-time database with serverless functions)
- **Web**: Next.js 16.0.1 with App Router, React 19.2.0, TypeScript, TailwindCSS
- **Mobile**: Expo React Native with TypeScript
- **Extension**: Wxt framework with Chrome APIs
- **Authentication**: Clerk with JWT integration
- **UI Components**: shadcn/ui with Radix primitives
- **File Storage**: Convex Storage for user uploads

## Development

```bash
# Start all services (frontend + backend)
bun run dev

# Individual services
bun run dev:backend      # Convex backend only
bun run dev:frontend     # Next.js web app only
bun run dev:mobile       # Expo mobile app
bun run dev:extension    # Browser extension with hot reload
bun run dev:docs         # Documentation site with hot reload

# Build commands
bun run build            # Production web build
bun run build:extension  # Extension build
bun run package:extension # Package extension for distribution

# Testing
bun run test             # Run e2e tests (web app)
bun run test:mobile      # Run mobile tests
bun run test:extension   # Run extension tests

# Documentation
bun run dev:docs         # Documentation development server
```

## Access Points

- **Web App**: http://localhost:3000
- **Admin Dashboard**: http://localhost:3000/admin (for admin users)
- **Convex Dashboard**: Opens automatically after `bun run predev`
- **Mobile App**: Expo Go app or simulator
- **Extension**: Load unpacked in Chrome developer mode
- **Documentation**: http://localhost:3001 (when running `bun run dev:docs`)

## Convex & Authentication Setup

### 1. Initialize Convex

```bash
bun run predev
```

This will:

- Create a new Convex deployment
- Open the Convex dashboard
- Generate your deployment URL

### 2. Set Up Clerk Authentication

1. **Create Clerk Application**:
   - Visit [clerk.com](https://clerk.com) and create an account
   - Create a new application
   - Choose authentication methods (email/password recommended)

2. **Get Your Keys**:
   - Publishable Key: `pk_test_...` (for frontend)
   - Secret Key: `sk_test_...` (for backend)

3. **Configure Clerk in Convex**:
   - In Convex dashboard: Settings → Authentication
   - Add Clerk as authentication provider
   - Enter your Clerk domain

### 3. Environment Configuration

**Backend** (`backend/.env.local`):

```bash
CONVEX_DEPLOYMENT=dev:your-deployment-name-123
CLERK_SECRET_KEY=sk_test_your_clerk_secret_key
```

**Web App** (`apps/web/.env.local`):

```bash
NEXT_PUBLIC_CONVEX_URL=https://your-deployment.convex.cloud
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_your_clerk_publishable_key
```

**Mobile App** (`apps/mobile/.env.local`):

```bash
EXPO_PUBLIC_CONVEX_URL=https://your-deployment.convex.cloud
EXPO_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_your_clerk_publishable_key
```

## Database & Functions

Unlike traditional databases, Convex provides:

- **Real-time queries** with automatic updates
- **Serverless functions** for business logic
- **Built-in authentication** integration
- **File storage** with secure access

### Function Development

```javascript
// Example query in convex/cards.ts
export const getCards = query({
  args: {},
  handler: async (ctx) => {
    const identity = await ctx.auth.getUserIdentity();
    if (!identity) return [];

    return await ctx.db
      .query("cards")
      .filter((q) => q.eq(q.field("userId"), identity.subject))
      .collect();
  },
});
```

## Card Processing Workflow

The application uses a workflow-based architecture to process cards through an AI pipeline:

### Pipeline Stages

Cards are processed sequentially through these stages:

1. **Classification** - Detect content type (text, link, image, etc.) and extract color palettes
2. **Categorization** - For link cards, enrich with provider metadata and category classification
3. **Metadata** - Generate AI-powered tags, summaries, and transcripts
4. **Renderables** - Create thumbnails and visual assets for media files

### Key Components

- **Workflows**: `backend/convex/workflows/cardProcessing.ts` orchestrates the pipeline
- **Steps**: Each stage in `backend/convex/workflows/steps/` contains mutations and processing logic
- **Processing Status**: Cards track progress via `processingStatus` field with stage updates
- **Link Metadata**: Special workflow in `backend/convex/workflows/linkMetadata.ts` handles link enrichment with retries
- **AI Backfill**: Workflow in `backend/convex/workflows/aiBackfill.ts` for retroactive AI processing
- **Card Cleanup**: Automated cleanup workflow for maintaining data quality

## Browser Extension Development

### Setup & Installation

1. **Build the extension**:

   ```bash
   bun run build:extension
   ```

2. **Load in Chrome**:
   - Go to `chrome://extensions/`
   - Enable "Developer mode"
   - Click "Load unpacked" and select `apps/extension/build/chrome-mv3-dev`

3. **Development with hot reload**:

   ```bash
   bun run dev:extension
   ```

4. **Firefox Extension Support**:
   ```bash
   bun run dev:firefox      # Firefox extension development
   bun run build:firefox    # Firefox extension build
   bun run zip:firefox      # Firefox extension packaging
   ```
